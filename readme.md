# Introduction
Code for the publication 

Buhl, M. (2022). Interpretable clinical decision-support system for audiology based on predicted Common Audiological Functional Parameters (CAFPAs). *Diagnostics*.

mareike.buhl@uol.de

# Structure 
For complete reproduction of all analyses and plots presented in the paper, run all scripts in the order according to the number included in the filenames. Scripts s4 and s5 need to be run twice while only changing the parameter `add_w_flag` (first 0 in script s4 and s5, then 1 in both). Generated results will be automatically saved in corresponding subfolders of `./results/`, and plots will be saved in corresponding subfolders of `./plots/`. For most of the final paper plots (Figures 3-8), `.tex` scripts exist in the plot folder that generate these plots. 

Data: Predicted CAFPAs as generated by the code of Saak et al. (2020) (Link) are stored in folder `./data/`, together with expert CAFPAs (and expert labels for diagnostic cases) collected by the survey of Buhl et al. (2020). 

All required subfolders will be generated automatically.



# Scripts 
1. Preprocessing: **`s1_preprocessing.m`**

    This script sorts predicted CAFPAs from different cross-validation folds (prediction according to Saak et al. (2020)) to a matrix to be used in following scripts.

2. Training: **`s2_training.m`**

    This script calculates training distributions based on expert and predicted CAFPAs, with patients sorted according to expert labels of Buhl et al. (2020). In the following, all classifications are based on expert distributions (assumption of a trained system).

3. Methods plots: **`s3_plots_theo_uncertainty.m`**

    This script plots training distributions and uncertainty depending on p_CAFPA values, as well as classification thresholds as overview about all CAFPAs and comparison sets.

4. Classification in comparison sets: **`s4_classification_data_labeled.m`**

    This script performs classification in comparison sets based on expert and predicted CAFPAs, using expert training distributions.

5. Evaluation classification in comparison sets: **`s5_plots_results_I_exp_pred.m`**

    This script evaluates classification in comparison sets and plots results.

6. Classification in tree sets: **`s6_classification_tree.m`**

    This script performs classification in tree sets.

7. Evaluation classification in tree sets: **`s7_plots_results_II_individual.m`**

    This script evaluates classification in tree sets and plots results.



# License

    Copyright (C) 2020-2021 Mareike Buhl 

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
